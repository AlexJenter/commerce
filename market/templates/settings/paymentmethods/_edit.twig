{% extends "market/_layouts/settingscp" %}

{% set crumbs = [
{ label: "Market Settings"|t, url: url('market/settings') },
{ label: "Payment Methods"|t, url: url('market/settings/paymentmethods') },
] %}

{% import "_includes/forms" as forms %}

{% set content %}

<form method="post" action="" accept-charset="UTF-8">
    <input type="hidden" name="action" value="market/paymentMethod/save">
    <input type="hidden" name="redirect" value="market/settings/paymentmethods">

    {{ getCsrfInput() }}

    <input type="hidden" name="paymentMethodClass" value="{{ paymentMethod.class }}"/>

    {% for paramKey, paramValue in paymentMethod.gateway.parameters %}
        {% if paramKey in paymentMethod.booleans %}
            {{ forms.checkboxField({
                first: loop.first,
                label: paymentMethod.generateAttributeLabel(paramKey)|t,
                name: 'settings['~paramKey~']',
                value: 1,
                checked : (paymentMethod.settings[paramKey] is defined ? paymentMethod.settings[paramKey] : false)
            }) }}
        {% elseif paymentMethod.selects[paramKey] is defined %}
            {{ forms.selectField({
                first: loop.first,
                label: paymentMethod.generateAttributeLabel(paramKey)|t,
                name: 'settings['~paramKey~']',
                options : paymentMethod.selects[paramKey],
                value : (paymentMethod.settings[paramKey] is defined ? paymentMethod.settings[paramKey] : '')
            }) }}
        {% else %}
            {{ forms.textField({
                first: loop.first,
                label: paymentMethod.generateAttributeLabel(paramKey)|t,
                name: 'settings['~paramKey~']',
                value : (paymentMethod.settings[paramKey] is defined ? paymentMethod.settings[paramKey] : '')
            }) }}
        {% endif %}

    {% endfor %}

    {% set noSettingsGateways = ['Manual','Dummy'] %}
    {% if paymentMethod.class in noSettingsGateways %}
        {% set isFirst = true %}
    {% else %}
        {% set isFirst = false %}
    {% endif %}
    {{ forms.checkboxField({
        first: isFirst,
        label: "Enabled for the front end"|t,
        name: 'frontendEnabled',
        checked: paymentMethod.frontendEnabled,
    }) }}

    <div class="buttons">
        <input type="submit" class="btn submit" value="{{ 'Save'|t }}">
    </div>

</form>

{% endset %}
