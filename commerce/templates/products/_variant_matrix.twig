{% from "commerce/products/_edit" import generalVariantFields, dimensionVariantFields %}

<div id="" class="pane">
	{% include "_includes/tabs" with {
		tabs: {
			variantsTab: { label: 'Variants'|t, url: '#variantsTab' }
		}
	} %}

	<input type="hidden" name="variants" value="">

	<div class="matrix" id="variant-matrix">
		<div class="blocks">
			{% set totalNewVariants = 0 %}
			{% for variant in variants %}
				{% set variantId = variant.id %}
				{% if not variantId %}
					{% set totalNewVariants = totalNewVariants + 1 %}
					{% set variantId = 'new'~totalNewVariants %}
				{% endif %}
				{% set inputNamePrefix = 'variants['~variantId~']' %}

				<div class="matrixblock{% if not variant.enabled %} disabled{% endif %}" data-id="{{ variantId }}"{#% if variant.collapsed %} data-collapsed{% endif %#}>
					<input type="hidden" name="{{ inputNamePrefix }}[enabled]" value="{% if variant.enabled %}1{% endif %}">
					<div class="titlebar">
						<div class="preview"></div>
					</div>
					<div class="checkbox" title="{{ 'Select'|t }}"></div>
					<div class="actions">
						<div class="status off" title="{{ 'Disabled'|t }}"></div>
						<a class="settings icon menubtn" title="{{ 'Actions'|t }}" role="button"></a>
						<div class="menu">
							<ul class="padded">
								<li><a data-icon="collapse" data-action="collapse">{{ "Collapse"|t }}</a></li>
								<li class="hidden"><a data-icon="expand" data-action="expand">{{ "Expand"|t }}</a></li>
								<li{% if not variant.enabled %} class="hidden"{% endif %}><a data-icon="disabled" data-action="disable">{{ "Disable"|t }}</a></li>
								<li{% if variant.enabled %} class="hidden"{% endif %}><a data-icon="enabled" data-action="enable">{{ "Enable"|t }}</a></li>
							</ul>
							<hr class="padded">
							<ul class="padded">
								<li><a data-icon="+" data-action="add">{{ "Add variant above"|t }}</a></li>
							</ul>
							<hr class="padded">
							<ul class="padded">
								<li><a data-icon="remove" data-action="delete">{{ "Delete"|t }}</a></li>
							</ul>
						</div>
						<a class="move icon" title="{{ 'Reorder'|t }}" role="button"></a>
					</div>
					<div class="fields meta">
						<div class="variant-properties">
							{% namespace inputNamePrefix %}
								{{ generalVariantFields(variant) }}
								{{ dimensionVariantFields(variant) }}
							{% endnamespace %}
						</div>
						<div class="custom-fields">
							{% include "_includes/fields" with {
								namespace: inputNamePrefix~'[fields]',
								element: variant,
								fields: variant.getFieldLayout().getFields()
							} %}
						</div>
					</div>
				</div>
			{% endfor %}
		</div>
		<div class="btn add icon">{{ "Add a variant"|t }}</div>
	</div>
</div>