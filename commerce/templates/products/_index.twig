{% extends "_layouts/elementindex" %}
{% hook 'commerce.prepCpTemplate' %}

{% set title = "Products"|t %}
{% set elementType = 'Commerce_Product' %}
{% set selectedTab = 'products' %}
{% set selectedSubnavItem = "products" %}


{% block sidebar %}
    {% if productTypes|length and taxCategories|length %}
        <div class="buttons">
            {% if productTypes|length > 1 %}
                <div class="btn submit menubtn add icon">{{ "New Product"|t }}</div>
                <div class="menu">
                    <ul>
                        {% for productType in productTypes %}
                            <li>
                                <a href="{{ url('commerce/products/'~productType.handle~'/new') }}">{{ productType.name|t }}</a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            {% else %}
                <a class="btn submit add icon"
                   href="{{ url('commerce/products/'~productTypes[0].handle~'/new') }}">{{ "New Product"|t }}</a>
            {% endif %}
        </div>
    {% endif %}

    {{ parent() }}
{% endblock %}


{% block content %}
    {% if not productTypes|length > 0 %}
        <p class="error">No product types exist yet. <a class="go" href="{{ url('commerce/settings/producttypes/new') }}">Create one</a></p>
    {% else %}
        {{ parent() }}
    {% endif %}
{% endblock %}


{% block initJs %}
    Craft.elementIndex = Craft.createElementIndex('{{ elementTypeClass }}', $('#main'), {
    context:        '{{ context }}',
    storageKey:     'elementindex.{{ elementTypeClass }}',
    criteria:       { localeEnabled: true }
    });
{% endblock %}
