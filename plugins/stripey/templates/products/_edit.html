{% extends "stripey/_layouts/cp" %}

{% set crumbs = [
{ label: "Stripey"|t, url: url('stripey') },
{ label: "Products"|t, url: url('stripey/products') }
] %}


{#
{% set selectedTab = 'products' %}
#}

{% import "_includes/forms" as forms %}

{% macro dateTimeField(product, attribute, label) %}

{% import "_includes/forms" as forms %}

{% set input %}
{{ forms.date({
id:        attribute,
name:      attribute,
value:     product.getAttribute(attribute),
errors:    product.getErrors(attribute),
}) }}

{{ forms.time({
id:        attribute,
name:      attribute,
value:     product.getAttribute(attribute),
errors:    product.getErrors(attribute),
}) }}
{% endset %}

{{ forms.field({
id:       attribute,
label:    label,
first:    (attribute == 'startDate'),
required: true
}, input) }}

{% endmacro %}


{% from _self import dateTimeField %}
{% set content %}

<form id="product-form" method="post" accept-charset="UTF-8">
    <input type="hidden" name="action" value="stripey/product/saveProduct">
    <input type="hidden" name="redirect" value="stripey/products">
    <input type="hidden" name="typeId" value="{{ productType.id }}">
    {{ getCsrfInput() }}
    {% if product.id %}<input type="hidden" name="productId" value="{{ product.id }}">{% endif %}



    <div>


        {% from "_includes/forms" import textField %}
        {% set static = static is defined ? static : false %}

        {{ textField({
        label: "Name"|t,
        locale: product.locale,
        id: 'title',
        name: 'title',
        value: product.title,
        errors: (not static ? product.getErrors('title')),
        first: true,
        autofocus: true,
        required: (not static),
        disabled: static,
        maxlength: 255
        }) }}

        {{ dateTimeField(product, 'availableOn', "Available On"|t, true) }}
        {{ dateTimeField(product, 'expiresOn', "Expires On"|t, false) }}

        <div>
            {% for tab in productType.getFieldLayout().getTabs() %}
            <div id="tab{{ loop.index }}"{% if not loop.first %} class="hidden"{% endif %}>
                {% include "_includes/fields" with {
                fields:  tab.getFields(),
                element: product,
                static:  (static is defined ? static : false)
                } only %}
            </div>
            {% endfor %}
        </div>


    </div>

    <div class="buttons">
        <div class="btngroup submit first">
            <input type="submit" class="btn submit" value="{{ 'Save'|t }}">
        </div>
        {% if not brandNewProduct %}
        <div class="btngroup">
        <input type="button" class="btn formsubmit" value="{{ 'Delete'|t }}" data-action="stripey/product/deleteProduct"
               data-confirm="{{ 'Are you sure you want to delete this product?'|t }}"
               data-redirect="stripey/products">
        </div>
        {% endif %}
    </div>
</form>

{% endset %}