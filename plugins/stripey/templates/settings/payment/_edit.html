{% import "_includes/forms" as forms %}

{% extends "_layouts/cp" %}

{% set title = payment.name %}

{% set crumbs = [
    { label: "Cellar"|t, url: url('cellar') },
    { label: "Settings"|t, url: url('cellar/settings') },
    { label: "Payment Methods"|t, url: url('cellar/settings/payment') },
] %}

{% set content %}

    <form method="post" action="" accept-charset="UTF-8">

        {#<input type="hidden" name="action" value="cellar/payment/save" />#}


        <input type="hidden" name="action" value="cellar/paymentSettings/save" />

        <input type="hidden" name="redirect" value="cellar/settings/payment" />
        <input type="hidden" name="payment[class]" value="{{payment.class}}" />

	    {{ forms.checkboxField({
	    	first: true,
	        label: "Enabled"|t,
	        name: 'payment[enabled]',
	        checked: (payment is not null ? payment.enabled : false)
	    }) }}

	    <hr />

		{% for paramKey, paramValue in payment.gateway.parameters %}

			{% if paramKey == 'testMode' or paramKey == 'developerMode' %}
			    {{ forms.checkboxField({
			        label: paramKey|t,
			        name: 'payment[settings]['~paramKey~']',
			        checked : (payment['settings'][paramKey] is defined ? payment.settings[paramKey] : false)
			    }) }}
			{% else %}
			    {{ forms.textField({
			        label: paramKey|t,
			        name: 'payment[settings]['~paramKey~']',
			        value : (payment['settings'][paramKey] is defined ? payment.settings[paramKey] : '')
			    }) }}
		    {% endif %}

		{% endfor %}

		<hr />

		<p><input type="submit" class="btn submit" value="Submit"></p>

	</form>

{% endset %}
